<?xml version="1.0" encoding="utf-8"?>
<project xmlns="http://www.plcopen.org/xml/tc6_0200">
  <fileHeader companyName="" productName="CODESYS" productVersion="CODESYS V3.5 SP16" creationDateTime="2021-03-14T16:13:54.7615185" />
  <contentHeader name="Traffic control simulator" version="1.0" modificationDateTime="2021-03-14T16:09:56.2863625" organization="TK Automation" author="Toni Kucic">
    <coordinateInfo>
      <fbd>
        <scaling x="1" y="1" />
      </fbd>
      <ld>
        <scaling x="1" y="1" />
      </ld>
      <sfc>
        <scaling x="1" y="1" />
      </sfc>
    </coordinateInfo>
    <addData>
      <data name="http://www.3s-software.com/plcopenxml/projectinformation" handleUnknown="implementation">
        <ProjectInformation>
          <property name="Author" type="string">Toni Kucic</property>
          <property name="Company" type="string">TK Automation</property>
          <property name="Project" type="string">plc_traffic_control</property>
          <property name="Title" type="string">Traffic control simulator</property>
          <property name="Version" type="version">1.0</property>
        </ProjectInformation>
      </data>
    </addData>
  </contentHeader>
  <types>
    <dataTypes />
    <pous>
      <pou name="CollisionDetection" pouType="functionBlock">
        <interface>
          <inputVars>
            <variable name="xcor1">
              <type>
                <REAL />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> X Coordinate of object 1 </xhtml>
              </documentation>
            </variable>
            <variable name="ycor1">
              <type>
                <REAL />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> Y Coordinate of object 1 </xhtml>
              </documentation>
            </variable>
            <variable name="height1">
              <type>
                <REAL />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> Height of object 1 </xhtml>
              </documentation>
            </variable>
            <variable name="width1">
              <type>
                <REAL />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> Width of object 1 </xhtml>
              </documentation>
            </variable>
            <variable name="xcor2">
              <type>
                <REAL />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> X Coordinate of object 2 </xhtml>
              </documentation>
            </variable>
            <variable name="ycor2">
              <type>
                <REAL />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> Y Coordinate of object 2 </xhtml>
              </documentation>
            </variable>
            <variable name="height2">
              <type>
                <REAL />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> Height of object 1 </xhtml>
              </documentation>
            </variable>
            <variable name="width2">
              <type>
                <REAL />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> Width of object 1 </xhtml>
              </documentation>
            </variable>
          </inputVars>
          <outputVars>
            <variable name="isCollision">
              <type>
                <BOOL />
              </type>
              <initialValue>
                <simpleValue value="FALSE" />
              </initialValue>
            </variable>
          </outputVars>
        </interface>
        <body>
          <ST>
            <xhtml xmlns="http://www.w3.org/1999/xhtml">IF xcor1 &lt; (xcor2 + width2) AND
   (xcor1 + width1) &gt; xcor2 AND
   ycor1 &lt; (ycor2 + height2) AND
  ( height1 + ycor1) &gt; ycor2 THEN
   isCollision := TRUE;
ELSE
	isCollision := FALSE;
END_IF</xhtml>
          </ST>
        </body>
        <addData>
          <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
            <ObjectId>90212427-8455-4030-88e5-8bce90b1fa00</ObjectId>
          </data>
        </addData>
      </pou>
      <pou name="MoveSprite" pouType="functionBlock">
        <interface>
          <inOutVars>
            <variable name="xCor">
              <type>
                <INT />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
            </variable>
            <variable name="yCor">
              <type>
                <INT />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
            </variable>
          </inOutVars>
          <inputVars>
            <variable name="xScreen">
              <type>
                <INT />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> Width of the screen </xhtml>
              </documentation>
            </variable>
            <variable name="yScreen">
              <type>
                <INT />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> Height of the screen </xhtml>
              </documentation>
            </variable>
            <variable name="SpriteWidth">
              <type>
                <INT />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> Width of the sprite </xhtml>
              </documentation>
            </variable>
            <variable name="SpriteHeight">
              <type>
                <INT />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> Height of the sprite </xhtml>
              </documentation>
            </variable>
            <variable name="ySpeed">
              <type>
                <INT />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> Control up or down movement with +- </xhtml>
              </documentation>
            </variable>
            <variable name="xSpeed">
              <type>
                <INT />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> Control left or right movement with +- </xhtml>
              </documentation>
            </variable>
          </inputVars>
        </interface>
        <body>
          <ST>
            <xhtml xmlns="http://www.w3.org/1999/xhtml">(* Reseting the position if sprite goes off screen *)
(* If moving left to right *)
IF xCor &gt;= xScreen  AND xSpeed &gt; 0 THEN
	xCor := -SpriteWidth;
(* If moving right to left *)
ELSIF xCor &lt;= -SpriteWidth AND xSpeed &lt; 0 THEN
	xCor := xScreen;	
END_IF
(* If moving from up, down *)
IF yCor &gt;= yScreen AND ySpeed &gt; 0 THEN
	yCor := -SpriteHeight;
(* If moving from down, up *)
ELSIF yCor &lt; -SpriteHeight AND ySpeed &lt; 0 THEN
	yCor := yScreen;	
END_IF

(* Actual moving of the coordinates *)
xCor := xCor + xSpeed;
yCor := yCor + ySpeed;
</xhtml>
          </ST>
        </body>
        <addData>
          <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
            <ObjectId>efe1e0d8-4162-41ed-bb90-87826e90fc6b</ObjectId>
          </data>
        </addData>
      </pou>
    </pous>
  </types>
  <instances>
    <configurations>
      <configuration name="SoftPLC">
        <resource name="Application">
          <task name="VISU_TASK" interval="PT0.05S" priority="31">
            <pouInstance name="VisuElems.Visu_Prg" typeName="">
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml" />
              </documentation>
            </pouInstance>
            <addData>
              <data name="http://www.3s-software.com/plcopenxml/tasksettings" handleUnknown="implementation">
                <TaskSettings KindOfTask="Cyclic" Interval="50" IntervalUnit="ms" WithinSPSTimeSlicing="true">
                  <Watchdog Enabled="false" TimeUnit="ms" />
                </TaskSettings>
              </data>
              <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                <ObjectId>36dd8743-addf-4031-9feb-dce731836678</ObjectId>
              </data>
            </addData>
          </task>
          <task name="xsim03" interval="PT0.005S" priority="1">
            <pouInstance name="xsim03" typeName="">
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml" />
              </documentation>
            </pouInstance>
            <addData>
              <data name="http://www.3s-software.com/plcopenxml/tasksettings" handleUnknown="implementation">
                <TaskSettings KindOfTask="Cyclic" Interval="t#5ms" WithinSPSTimeSlicing="true">
                  <Watchdog Enabled="false" TimeUnit="ms" Sensitivity="1" />
                </TaskSettings>
              </data>
              <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                <ObjectId>c932c134-12d7-42e6-b914-4e02f89670bf</ObjectId>
              </data>
            </addData>
          </task>
          <task name="xc03_Task" interval="PT0.05S" priority="1">
            <pouInstance name="xc03_TrafficControl" typeName="">
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml" />
              </documentation>
            </pouInstance>
            <addData>
              <data name="http://www.3s-software.com/plcopenxml/tasksettings" handleUnknown="implementation">
                <TaskSettings KindOfTask="Cyclic" Interval="t#50ms" WithinSPSTimeSlicing="true">
                  <Watchdog Enabled="false" TimeUnit="ms" Sensitivity="1" />
                </TaskSettings>
              </data>
              <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                <ObjectId>99ee3542-719b-4cde-8cf7-54a7ea62a49a</ObjectId>
              </data>
            </addData>
          </task>
          <globalVars name="xgv03">
            <variable name="cfgPeriodTime">
              <type>
                <TIME />
              </type>
              <initialValue>
                <simpleValue value="TIME#1m24s0ms" />
              </initialValue>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml">Configuration</xhtml>
              </documentation>
            </variable>
            <variable name="cfgStartDirection">
              <type>
                <DINT />
              </type>
              <initialValue>
                <simpleValue value="0" />
              </initialValue>
            </variable>
            <variable name="TLight1Red">
              <type>
                <BOOL />
              </type>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> DIGITAL OUTPUT	Activate red light traffic light 1 </xhtml>
              </documentation>
            </variable>
            <variable name="TLight1Yellow">
              <type>
                <BOOL />
              </type>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> DIGITAL OUTPUT	Activate yellow light traffic light 1 </xhtml>
              </documentation>
            </variable>
            <variable name="TLight1Green">
              <type>
                <BOOL />
              </type>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> DIGITAL OUTPUT	Activate green light traffic light 1 </xhtml>
              </documentation>
            </variable>
            <variable name="TLight2Red">
              <type>
                <BOOL />
              </type>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> DIGITAL OUTPUT	Activate red light traffic light 2 </xhtml>
              </documentation>
            </variable>
            <variable name="TLight2Yellow">
              <type>
                <BOOL />
              </type>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> DIGITAL OUTPUT	Activate yellow light traffic light 2 </xhtml>
              </documentation>
            </variable>
            <variable name="TLight2Green">
              <type>
                <BOOL />
              </type>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> DIGITAL OUTPUT	Activate green light traffic light 2 </xhtml>
              </documentation>
            </variable>
            <variable name="TLight3Red">
              <type>
                <BOOL />
              </type>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> DIGITAL OUTPUT	Activate red light traffic light 3 </xhtml>
              </documentation>
            </variable>
            <variable name="TLight3Yellow">
              <type>
                <BOOL />
              </type>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> DIGITAL OUTPUT	Activate yellow light traffic light 3 </xhtml>
              </documentation>
            </variable>
            <variable name="TLight3Green">
              <type>
                <BOOL />
              </type>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> DIGITAL OUTPUT	Activate green light traffic light 3 </xhtml>
              </documentation>
            </variable>
            <variable name="TLight4Red">
              <type>
                <BOOL />
              </type>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> DIGITAL OUTPUT	Activate red light traffic light 4 </xhtml>
              </documentation>
            </variable>
            <variable name="TLight4Yellow">
              <type>
                <BOOL />
              </type>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> DIGITAL OUTPUT	Activate yellow light traffic light 4 </xhtml>
              </documentation>
            </variable>
            <variable name="TLight4Green">
              <type>
                <BOOL />
              </type>
              <documentation>
                <xhtml xmlns="http://www.w3.org/1999/xhtml"> DIGITAL OUTPUT	Activate green light traffic light 4 </xhtml>
              </documentation>
            </variable>
            <addData>
              <data name="http://www.3s-software.com/plcopenxml/attributes" handleUnknown="implementation">
                <Attributes>
                  <Attribute Name="qualified_only" Value="" />
                </Attributes>
              </data>
              <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                <ObjectId>45b9d55d-90d0-48a9-8d7e-2af6e1714d26</ObjectId>
              </data>
            </addData>
          </globalVars>
          <addData>
            <data name="http://www.3s-software.com/plcopenxml/pou" handleUnknown="implementation">
              <pou name="xc03_TrafficControl" pouType="program">
                <interface>
                  <localVars>
                    <variable name="vSequenceA">
                      <type>
                        <DINT />
                      </type>
                      <initialValue>
                        <simpleValue value="1" />
                      </initialValue>
                    </variable>
                    <variable name="TimerA">
                      <type>
                        <derived name="TOF" />
                      </type>
                    </variable>
                    <variable name="vSequenceB">
                      <type>
                        <DINT />
                      </type>
                      <initialValue>
                        <simpleValue value="0" />
                      </initialValue>
                    </variable>
                    <variable name="TimerB">
                      <type>
                        <derived name="TOF" />
                      </type>
                    </variable>
                    <variable name="Start">
                      <type>
                        <BOOL />
                      </type>
                    </variable>
                    <variable name="StartOld">
                      <type>
                        <BOOL />
                      </type>
                    </variable>
                    <variable name="vSequence">
                      <type>
                        <DINT />
                      </type>
                      <initialValue>
                        <simpleValue value="0" />
                      </initialValue>
                    </variable>
                    <variable name="TactTimer">
                      <type>
                        <derived name="TON" />
                      </type>
                    </variable>
                    <variable name="vPeriodTime">
                      <type>
                        <TIME />
                      </type>
                      <initialValue>
                        <simpleValue value="TIME#1m25s0ms" />
                      </initialValue>
                    </variable>
                    <variable name="vElapsedTime">
                      <type>
                        <TIME />
                      </type>
                    </variable>
                  </localVars>
                </interface>
                <body>
                  <ST>
                    <xhtml xmlns="http://www.w3.org/1999/xhtml">
TactTimer(IN:=TRUE, PT:=vPeriodTime, ET =&gt; vElapsedTime);
IF TactTimer.Q THEN
	TactTimer(IN:=FALSE);
END_IF
(* Direction Up, Down traffic light *)
xgv03.TLight3Red := vElapsedTime &lt;= T#5S OR vElapsedTime &gt;= T#37S AND vElapsedTime &lt;= T#85S;
xgv03.TLight3Yellow := vElapsedTime &gt; T#3S AND vElapsedTime &lt;= T#5S OR vElapsedTime &gt;= T#35S AND vElapsedTime &lt;= T#37S;
xgv03.TLight3Green := vElapsedTime &gt;= T#5S AND vElapsedTime &lt;= T#35S;

(* Mirror the other side of the Up, Down direction *)
xgv03.TLight4Red := xgv03.TLight3Red;
xgv03.TLight4Yellow := xgv03.TLight3Yellow;
xgv03.TLight4Green := xgv03.TLight3Green;

(* Direction Left, Right traffic light *)
xgv03.TLight2Red := vElapsedTime &gt;= T#0S AND vElapsedTime &lt;= T#39S OR vElapsedTime &gt;= T#71S AND vElapsedTime &lt;= T#85S;
xgv03.TLight2Yellow := vElapsedTime &gt; T#37S AND vElapsedTime &lt;= T#39S OR vElapsedTime &gt;= T#69S AND vElapsedTime &lt;= T#71S;
xgv03.TLight2Green := vElapsedTime &gt;= T#39S AND vElapsedTime &lt;= T#69S;

(* Mirror the other side of the Left, Right direction *)
xgv03.TLight1Red := xgv03.TLight2Red;
xgv03.TLight1Yellow := xgv03.TLight2Yellow;
xgv03.TLight1Green := xgv03.TLight2Green;
(*CASE vSequence OF
	0:
	(* Starting sequence, direction Up, Down *)
	TimerA
	Task03GVL.TLight1Red := TRUE;
	
END_CASE
CASE vSequenceA OF
	0: TimerA(IN:=FALSE,PT:=T#20S);
	Task03GVL.TLight1Yellow:= FALSE;
	Task03GVL.TLight1Red:= FALSE;
	Task03GVL.TLight1Green:= TimerA.Q;
	Task03GVL.TLight2Green := Task03GVL.TLight1Green;
	IF NOT TimerA.Q THEN
		TimerA(IN:=TRUE);
		vSequenceA:=1;
	END_IF
	1: TimerA(IN:=FALSE,PT:=T#4S);
	Task03GVL.TLight1Red:= FALSE;
	Task03GVL.TLight1Green:= FALSE;
	Task03GVL.TLight1Yellow:= TimerA.Q;
	Task03GVL.TLight2Yellow := Task03GVL.TLight1Yellow;
	IF NOT TimerA.Q THEN
		TimerA(IN:=TRUE);
		vSequenceA:=2;
	END_IF
		2: TimerA(IN:=FALSE,PT:=T#30S);
	Task03GVL.TLight1Green:= FALSE;
	Task03GVL.TLight1Yellow:= FALSE;
	Task03GVL.TLight1Red:= TimerA.Q;
	Task03GVL.TLight2Red := Task03GVL.TLight1Red;
	IF NOT TimerA.Q THEN
		TimerA(IN:=TRUE);
		vSequenceA:=3;
	END_IF
		3: TimerA(IN:=FALSE,PT:=T#4S);
	Task03GVL.TLight1Green:= FALSE;
	Task03GVL.TLight1Red:= TimerA.Q;
	Task03GVL.TLight1Yellow:= TimerA.Q;
	Task03GVL.TLight2Red := Task03GVL.TLight1Red;
	Task03GVL.TLight2Yellow := Task03GVL.TLight1Yellow;
	IF NOT TimerA.Q THEN
		TimerA(IN:=TRUE);
		vSequenceA:=0;
		IF vSequenceB=6 THEN
		vSequenceB:=3;	
		END_IF
		
	END_IF
END_CASE

CASE vSequenceB OF
	0: TimerB(IN:=FALSE,PT:=T#4S);
	Task03GVL.TLight3Green:= FALSE;
	Task03GVL.TLight3Red:= TimerB.Q;
	Task03GVL.TLight3Yellow:= TimerB.Q;
	Task03GVL.TLight4Red := Task03GVL.TLight3Red;
	Task03GVL.TLight4Yellow := Task03GVL.TLight3Yellow;
	IF NOT TimerB.Q THEN
		TimerB(IN:=TRUE);
		vSequenceB:=1;
	END_IF
	
	1: TimerB(IN:=FALSE,PT:=T#20S);
	Task03GVL.TLight3Yellow:= FALSE;
	Task03GVL.TLight3Red:= FALSE;
	Task03GVL.TLight3Green:= TimerB.Q;
	Task03GVL.TLight4Green := Task03GVL.TLight3Green;
	IF NOT TimerB.Q THEN
		TimerB(IN:=TRUE);
		vSequenceB:=2;
	END_IF
	
	2: TimerB(IN:=FALSE,PT:=T#4S);
	Task03GVL.TLight3Red:= FALSE;
	Task03GVL.TLight3Green:= FALSE;
	Task03GVL.TLight3Yellow:= TimerB.Q;
	Task03GVL.TLight4Yellow := Task03GVL.TLight3Yellow;
	IF NOT TimerB.Q THEN
		TimerB(IN:=TRUE);
		vSequenceB:=3;
	END_IF
	
		3: TimerB(IN:=FALSE,PT:=T#30S);
	Task03GVL.TLight3Green:= FALSE;
	Task03GVL.TLight3Yellow:= FALSE;
	Task03GVL.TLight3Red:= TimerB.Q;
	Task03GVL.TLight4Red := Task03GVL.TLight3Red;
	IF NOT TimerB.Q THEN
		TimerB(IN:=TRUE);
		vSequenceB:=0;
	END_IF
		
END_CASE
END_IF;*)</xhtml>
                  </ST>
                </body>
                <addData>
                  <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                    <ObjectId>e7eb72fd-dd19-4d64-b3b3-1d670977a2d9</ObjectId>
                  </data>
                </addData>
              </pou>
            </data>
            <data name="http://www.3s-software.com/plcopenxml/pou" handleUnknown="implementation">
              <pou name="xsim03" pouType="program">
                <interface>
                  <localVars>
                    <variable name="Car1X">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="925" />
                      </initialValue>
                      <documentation>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml"> Red car </xhtml>
                      </documentation>
                    </variable>
                    <variable name="Car1Y">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="740" />
                      </initialValue>
                    </variable>
                    <variable name="Car1Width">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="100" />
                      </initialValue>
                    </variable>
                    <variable name="Car1Height">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="230" />
                      </initialValue>
                    </variable>
                    <variable name="Car2X">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="420" />
                      </initialValue>
                      <documentation>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml"> Blue car </xhtml>
                      </documentation>
                    </variable>
                    <variable name="Car2Y">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="511" />
                      </initialValue>
                    </variable>
                    <variable name="Car2Width">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="230" />
                      </initialValue>
                    </variable>
                    <variable name="Car2Height">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="100" />
                      </initialValue>
                    </variable>
                    <variable name="Car3X">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="1160" />
                      </initialValue>
                      <documentation>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml"> Green car </xhtml>
                      </documentation>
                    </variable>
                    <variable name="Car3Y">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="366" />
                      </initialValue>
                    </variable>
                    <variable name="Car3Width">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="230" />
                      </initialValue>
                    </variable>
                    <variable name="Car3Height">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="100" />
                      </initialValue>
                    </variable>
                    <variable name="Car4X">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="775" />
                      </initialValue>
                      <documentation>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml"> Yellow car </xhtml>
                      </documentation>
                    </variable>
                    <variable name="Car4Y">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="0" />
                      </initialValue>
                    </variable>
                    <variable name="Car4Width">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="100" />
                      </initialValue>
                    </variable>
                    <variable name="Car4Height">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="230" />
                      </initialValue>
                    </variable>
                    <variable name="Speed">
                      <type>
                        <INT />
                      </type>
                      <initialValue>
                        <simpleValue value="1" />
                      </initialValue>
                    </variable>
                    <variable name="vCarCrash">
                      <type>
                        <BOOL />
                      </type>
                    </variable>
                    <variable name="vReset">
                      <type>
                        <BOOL />
                      </type>
                    </variable>
                    <variable name="xExplosion">
                      <type>
                        <INT />
                      </type>
                    </variable>
                    <variable name="yExplosion">
                      <type>
                        <INT />
                      </type>
                    </variable>
                    <variable name="Car3Car4Coll">
                      <type>
                        <derived name="CollisionDetection" />
                      </type>
                    </variable>
                    <variable name="Car3Car1Coll">
                      <type>
                        <derived name="CollisionDetection" />
                      </type>
                    </variable>
                    <variable name="Car2Car1Coll">
                      <type>
                        <derived name="CollisionDetection" />
                      </type>
                    </variable>
                    <variable name="Car2Car4Coll">
                      <type>
                        <derived name="CollisionDetection" />
                      </type>
                    </variable>
                    <variable name="MoveCar1">
                      <type>
                        <derived name="MoveSprite" />
                      </type>
                    </variable>
                    <variable name="MoveCar2">
                      <type>
                        <derived name="MoveSprite" />
                      </type>
                    </variable>
                    <variable name="MoveCar3">
                      <type>
                        <derived name="MoveSprite" />
                      </type>
                    </variable>
                    <variable name="MoveCar4">
                      <type>
                        <derived name="MoveSprite" />
                      </type>
                    </variable>
                  </localVars>
                </interface>
                <body>
                  <ST>
                    <xhtml xmlns="http://www.w3.org/1999/xhtml">(* Collision detection *)
(* Car3 and Car 4 *)
Car3Car4Coll(
	xcor1:= Car3X, 
	ycor1:= Car3Y, 
	height1:= Car3Height, 
	width1:= Car3Width, 
	xcor2:= Car4X, 
	ycor2:= Car4Y, 
	height2:= Car4Height, 
	width2:= Car4Width);
(* Car3 and Car 1 *)
Car3Car1Coll(
	xcor1:= Car3X, 
	ycor1:= Car3Y, 
	height1:= Car3Height, 
	width1:= Car3Width, 
	xcor2:= Car1X, 
	ycor2:= Car1Y, 
	height2:= Car1Height, 
	width2:= Car1Width);
(* Car2 and Car 4 *)
Car2Car4Coll(
	xcor1:= Car2X, 
	ycor1:= Car2Y, 
	height1:= Car2Height, 
	width1:= Car2Width, 
	xcor2:= Car4X, 
	ycor2:= Car4Y, 
	height2:= Car4Height, 
	width2:= Car4Width);
(* Car2 and Car 1 *)
Car2Car1Coll(
	xcor1:= Car2X, 
	ycor1:= Car2Y, 
	height1:= Car2Height, 
	width1:= Car2Width, 
	xcor2:= Car1X, 
	ycor2:= Car1Y, 
	height2:= Car1Height, 
	width2:= Car1Width);

IF Car3Car4Coll.isCollision OR Car3Car1Coll.isCollision OR Car2Car4Coll.isCollision OR Car2Car1Coll.isCollision THEN
	vCarCrash := TRUE;
ELSE
	vCarCrash := FALSE;	
END_IF

(* Explosion graphic *)
IF Car3Car4Coll.isCollision THEN
	xExplosion := Car3X;
	yExplosion := Car3Y;
ELSIF Car3Car1Coll.isCollision THEN
	xExplosion := Car3X;
	yExplosion := Car3Y;
ELSIF Car2Car4Coll.isCollision THEN
	xExplosion := Car2X + Car2Width;
	yExplosion := Car2Y;
ELSIF Car2Car1Coll.isCollision THEN
	xExplosion := Car2X + Car2Width;
	yExplosion := Car2Y;
ELSE
	xExplosion := 2000;
	yExplosion := 2000;
END_IF

(* Car movements *)
IF  vCarCrash THEN
	//wait
	IF vReset THEN
		(* Reset to start position *)
		Car1X:= 925;
		Car1Y:= 740;
		Car2X:= 420;
		Car2Y:= 511;
		Car3X:= 1160;
		Car3Y:= 366;
		Car4X:= 775;
		Car4Y:= 0;
	END_IF
ELSE
	(* Define what cars do depending on lights *)
	(* car moves if its green for him or he is past the traffic ligght but stops at the traffic light if its red, or yellow.*)
	IF xgv03.TLight4Green OR Car1Y - 740 &lt; 0 OR Car1Y - 740 &gt; Speed THEN
		MoveCar1(
		xCor:= Car1X, 
		yCor:= Car1Y, 
		xScreen:= 1830, 
		yScreen:= 930,
		SpriteWidth:= Car1Width, 
		SpriteHeight:= Car1Height, 
		ySpeed:= -Speed, 
		xSpeed:= 0 );
	END_IF;
	IF xgv03.TLight2Green OR Car2X - 420 &lt; 0 OR Car2X - 420 &gt; Speed THEN
		MoveCar2(
		xCor:= Car2X, 
		yCor:= Car2Y, 
		xScreen:= 1830, 
		yScreen:= 930,
		SpriteWidth:= Car2Width, 
		SpriteHeight:= Car2Height,  
		ySpeed:= 0, 
		xSpeed:= Speed );
	END_IF;
	IF xgv03.TLight1Green OR Car3X - 1160 &lt; 0 OR Car3X - 1160 &gt; Speed THEN
		MoveCar3(
		xCor:= Car3X, 
		yCor:= Car3Y, 
		xScreen:= 1830, 
		yScreen:= 930,
		SpriteWidth:= Car3Width, 
		SpriteHeight:= Car3Height,  
		ySpeed:= 0, 
		xSpeed:= -Speed );
	END_IF;
	IF xgv03.TLight3Green OR Car4Y - 0 &lt; 0 OR Car4Y - 0 &gt; Speed THEN
		MoveCar4(
		xCor:= Car4X, 
		yCor:= Car4Y, 
		xScreen:= 1830, 
		yScreen:= 930,
		SpriteWidth:= Car4Width, 
		SpriteHeight:= Car4Height,  
		ySpeed:= Speed, 
		xSpeed:= 0 );
	END_IF;
END_IF

</xhtml>
                  </ST>
                </body>
                <addData>
                  <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                    <ObjectId>e8cc3a31-36c9-4946-a8e8-c5e86e24c67e</ObjectId>
                  </data>
                </addData>
              </pou>
            </data>
            <data name="http://www.3s-software.com/plcopenxml/libraries" handleUnknown="implementation">
              <Libraries>
                <Library Name="#Standard" Namespace="Standard" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="false" LinkAllContent="false" DefaultResolution="Standard, * (System)" />
                <Library Name="#Util" Namespace="Util" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="false" LinkAllContent="false" DefaultResolution="Util, * (System)">
                  <Parameters>
                    <Parameter Name="IBLOCKSIZE" Value="22800" />
                  </Parameters>
                </Library>
                <Library Name="#Standard64" Namespace="Standard64" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="false" LinkAllContent="false" DefaultResolution="Standard64, * (System)" />
                <Library Name="#VisuDialogs" Namespace="VisuDialogs" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="false" LinkAllContent="false" DefaultResolution="VisuDialogs, * (System)" />
                <Library Name="#IoStandard" Namespace="IoStandard" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="true" DefaultResolution="IoStandard, 3.5.13.0 (System)" />
                <Library Name="#3SLicense" Namespace="_3S_LICENSE" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="3SLicense, 0.0.0.0 (3S - Smart Software Solutions GmbH)" ResolverGuid="97c3b452-d9fa-4ac2-9d0c-3d420aa6d95b" />
                <Library Name="#BreakpointLogging" Namespace="BPLog" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="Breakpoint Logging Functions, 3.5.5.0 (3S - Smart Software Solutions GmbH)" />
                <Library Name="#System_VisuElems" Namespace="VisuElems" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElems, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
                <Library Name="#System_VisuElemMeter" Namespace="VisuElemMeter" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemMeter, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
                <Library Name="#System_VisuElemsSpecialControls" Namespace="VisuElemsSpecialControls" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemsSpecialControls, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
                <Library Name="#System_VisuElemsWinControls" Namespace="VisuElemsWinControls" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemsWinControls, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
                <Library Name="#System_VisuElemTextEditor" Namespace="VisuElemTextEditor" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemTextEditor, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
                <Library Name="#System_VisuElemTrace" Namespace="VisuElemTrace" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemTrace, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
                <Library Name="#System_VisuNativeControl" Namespace="VisuNativeControl" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuNativeControl, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
                <Library Name="#System_VisuElemsAlarm" Namespace="VisuElemsAlarm" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemsAlarm, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
                <Library Name="#System_VisuElemCamDisplayer" Namespace="VisuElemCamDisplayer" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemCamDisplayer, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae">
                  <Parameters>
                    <Parameter Name="GC_POINTS_PER_CAM" Value="100" />
                  </Parameters>
                </Library>
                <Library Name="#System_VisuElem3DPath" Namespace="VisuElem3DPath" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElem3DPath, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae">
                  <Parameters>
                    <Parameter Name="GC_POINTS_PER_POLYGON" Value="100" />
                  </Parameters>
                </Library>
                <Library Name="#System_VisuElemsDateTime" Namespace="VisuElemsDateTime" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemsDateTime, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
                <Library Name="#System_VisuElemXYChart" Namespace="VisuElemXYChart" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemXYChart, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
                <Library Name="#system_visuinputs" Namespace="visuinputs" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="visuinputs, 3.5.16.0 (system)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
                <addData>
                  <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                    <ObjectId>29e9a39f-d9e1-4ae5-8462-7b18ca48243c</ObjectId>
                  </data>
                </addData>
              </Libraries>
            </data>
            <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
              <ObjectId>e86a3aad-ca93-4d44-88a5-66019f089c92</ObjectId>
            </data>
          </addData>
        </resource>
        <addData>
          <data name="Device" handleUnknown="discard">
            <Device xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="">
              <DeviceType>
                <DeviceIdentification>
                  <Type>4097</Type>
                  <Id>0000 000a</Id>
                  <Version>3.5.16.0</Version>
                </DeviceIdentification>
                <Connector moduleType="256" interface="Common.PCI" connectorId="0">
                  <HostParameterSet />
                </Connector>
                <Connector moduleType="769" interface="SafetyInterface" connectorId="1">
                  <HostParameterSet />
                </Connector>
                <DeviceParameterSet />
              </DeviceType>
            </Device>
          </data>
          <data name="configurations" handleUnknown="discard">
            <configurations />
          </data>
          <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
            <ObjectId>83075d4d-9f61-4b3f-9b20-72bffe864b6d</ObjectId>
          </data>
        </addData>
      </configuration>
    </configurations>
  </instances>
  <addData>
    <data name="http://www.3s-software.com/plcopenxml/libraries" handleUnknown="implementation">
      <Libraries>
        <Library Name="VisuSymbols, 3.5.10.0 (System)" Namespace="VisuSymbols" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="false" LinkAllContent="false" />
        <Library Name="#System_VisuElems" Namespace="VisuElems" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElems, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
        <Library Name="#System_VisuElemMeter" Namespace="VisuElemMeter" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemMeter, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
        <Library Name="#System_VisuElemsSpecialControls" Namespace="VisuElemsSpecialControls" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemsSpecialControls, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
        <Library Name="#System_VisuElemsWinControls" Namespace="VisuElemsWinControls" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemsWinControls, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
        <Library Name="#System_VisuElemTextEditor" Namespace="VisuElemTextEditor" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemTextEditor, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
        <Library Name="#System_VisuElemTrace" Namespace="VisuElemTrace" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemTrace, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
        <Library Name="#System_VisuNativeControl" Namespace="VisuNativeControl" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuNativeControl, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
        <Library Name="#System_VisuElemsAlarm" Namespace="VisuElemsAlarm" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemsAlarm, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
        <Library Name="#System_VisuElemCamDisplayer" Namespace="VisuElemCamDisplayer" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemCamDisplayer, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae">
          <Parameters>
            <Parameter Name="GC_POINTS_PER_CAM" Value="100" />
          </Parameters>
        </Library>
        <Library Name="#System_VisuElem3DPath" Namespace="VisuElem3DPath" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElem3DPath, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae">
          <Parameters>
            <Parameter Name="GC_POINTS_PER_POLYGON" Value="100" />
          </Parameters>
        </Library>
        <Library Name="#System_VisuElemsDateTime" Namespace="VisuElemsDateTime" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemsDateTime, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
        <Library Name="#System_VisuElemXYChart" Namespace="VisuElemXYChart" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="VisuElemXYChart, 3.5.16.0 (System)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
        <Library Name="#system_visuinputs" Namespace="visuinputs" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="true" LinkAllContent="false" DefaultResolution="visuinputs, 3.5.16.0 (system)" ResolverGuid="2717eb6a-dd07-4c66-8d8d-cacebd7b18ae" />
        <addData>
          <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
            <ObjectId>497477f5-d561-4978-840d-bbcb3520b9e4</ObjectId>
          </data>
        </addData>
      </Libraries>
    </data>
    <data name="http://www.3s-software.com/plcopenxml/projectstructure" handleUnknown="discard">
      <ProjectStructure>
        <Object Name="SoftPLC" ObjectId="83075d4d-9f61-4b3f-9b20-72bffe864b6d">
          <Object Name="Application" ObjectId="e86a3aad-ca93-4d44-88a5-66019f089c92">
            <Object Name="Library Manager" ObjectId="29e9a39f-d9e1-4ae5-8462-7b18ca48243c" />
            <Folder Name="Control">
              <Object Name="xc03_TrafficControl" ObjectId="e7eb72fd-dd19-4d64-b3b3-1d670977a2d9" />
            </Folder>
            <Object Name="VISU_TASK" ObjectId="36dd8743-addf-4031-9feb-dce731836678" />
            <Object Name="xsim03" ObjectId="c932c134-12d7-42e6-b914-4e02f89670bf" />
            <Object Name="xc03_Task" ObjectId="99ee3542-719b-4cde-8cf7-54a7ea62a49a" />
            <Folder Name="IO">
              <Object Name="xgv03" ObjectId="45b9d55d-90d0-48a9-8d7e-2af6e1714d26" />
            </Folder>
            <Folder Name="Simulator">
              <Object Name="xsim03" ObjectId="e8cc3a31-36c9-4946-a8e8-c5e86e24c67e" />
            </Folder>
          </Object>
        </Object>
        <Object Name="Library Manager" ObjectId="497477f5-d561-4978-840d-bbcb3520b9e4" />
        <Object Name="CollisionDetection" ObjectId="90212427-8455-4030-88e5-8bce90b1fa00" />
        <Object Name="MoveSprite" ObjectId="efe1e0d8-4162-41ed-bb90-87826e90fc6b" />
        <Object Name="Project Information" ObjectId="11c0fc3a-9bcf-4dd8-ac38-efb93363e521" />
      </ProjectStructure>
    </data>
  </addData>
</project>